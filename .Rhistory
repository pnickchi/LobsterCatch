p$howClose             <- param$howClose[i]
p$dStep                <- param$dStep[i]
p$lengthBased          <- param$lengthBased[i]
p$lobsterSizeFile      <- param$lobsterSizeFile
p$lobLengthThreshold   <- param$lobLengthThreshold[i]
p$trapSaturation       <- param$trapSaturation[i]
p$q0                   <- param$q0[i]
p$qmin                 <- param$qmin[i]
p$realizations         <- param$realizations[i]
p$tSteps               <- param$tSteps[i]
p$sexBased             <- param$sexBased[i]
p$lobsterSexDist       <- param$lobsterSexDist
print( paste0('Run the simulation for parameter setting = ', i) )
Simrun[[i]]            <- SimulateLobsterMovement(p)
Results[[i]]           <- GetSimOutput(Simrun[[i]])
resultdfcomplete[[i]]  <- GetdfComplete(x = Results[[i]], extp = p)
saveRDS(object = resultdfcomplete[[i]], file = paste0('Set', i, '_varyingShrinkage', '.rds'))
}
initlambda
howClose
shrinkage
dStep
Set9_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set9_varyingShrinkage.rds")
View(Set9_varyingShrinkage)
Set8_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set8_varyingShrinkage.rds")
View(Set8_varyingShrinkage)
Set6_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set6_varyingShrinkage.rds")
View(Set6_varyingShrinkage)
Set1_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set1_varyingShrinkage.rds")
View(Set1_varyingShrinkage)
Set2_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set2_varyingShrinkage.rds")
View(Set2_varyingShrinkage)
Set3_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/Set3_varyingShrinkage.rds")
shrinkage
setwd("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/shrinkageImpact")
# Define function
GetdfComplete = function(x, extp){
temp           <- bind_cols(x)
density             <- rep.int(p$initlambda,          p$realizations)
dstepmov            <- rep.int(p$dStep,               p$realizations)
saturationThreshold <- rep.int(p$saturationThreshold, p$realizations)
baitShrinkage       <- rep.int(p$shrinkage,           p$realizations)
howClose            <- rep.int(p$howClose,            p$realizations)
trapSaturation      <- rep.int(p$trapSaturation,      p$realizations)
res <- bind_cols(temp, density, dstepmov, saturationThreshold, baitShrinkage, howClose, trapSaturation)
clNames <- c(
paste0('TimeToMax_Trap',    1:ncol(x$TimeToMax)),
paste0('MaxCatch_Trap',     1:ncol(x$MaxCatch)),
paste0('LegalCatchWt_Trap', 1:ncol(x$LegalCatchWt)),
paste0('TotalCatchWt_Trap', 1:ncol(x$TotalCatchWt))
)
colnames(res) <- c(clNames,'densitylambda','dstepmov','saturationThreshold','baitShrinkage', 'howClose', 'trapSaturation')
return(res)
}
initlambda          <- 0.5
howClose            <- c(0.5) #The distance from trap withing which a lobster considered trapped
shrinkage           <- c(0.95, 0.96, 0.97, 0.975,0.985, 0.995, 1)
dStep               <- 5
nsettings <- length(initlambda) * length(howClose) * length(shrinkage) * length(dStep)
# Variables with fixed values: can be also changed if needed
nrowgrids           <- rep(200, nsettings)
ncolgrids           <- rep(200, nsettings)
unitarea            <- rep(100, nsettings)
initD               <- rep(3,   nsettings)
currentZoI          <- rep(15,  nsettings)
radiusOfInfluence   <- rep(15,  nsettings)
saturationThreshold <- rep(5,   nsettings)
Trap                <- rep(list( data.frame(x = c(100), y = c(100)) ), nsettings)
ntraps              <- unlist( lapply(X = Trap, nrow) )
lobLengthThreshold  <- rep(115, nsettings)
q0                  <- rep(0.5, nsettings)
realizations        <- rep(50,  nsettings)#number of simulations
tSteps              <- rep(50, nsettings)
sexBased            <- rep(TRUE, nsettings)
lengthBased         <- rep(TRUE, nsettings)
trapSaturation      <- rep(TRUE, nsettings)
qmin                <- rep(0, nsettings) #need to change to 0 when trap saturation is TRUE
lobsterSizeFile     <- 'https://raw.githubusercontent.com/vpourfaraj/lobsterCatch/main/inst/extdata/LobsterSizeFreqs.csv'
lobsterSexDist      <- list(labels = c('M','F','MM','BF'),
prob1 = c(0.55,0.35,0.05,0.05),
prob2 = c(0.5,0.50,0,0),
lobsterMatThreshold = 100)
temp <- expand.grid(initlambda, howClose, shrinkage, dStep)
initlambda <- temp$Var1
howClose   <- temp$Var2
shrinkage  <- temp$Var3
dStep      <- temp$Var4
param <- list( nrowgrids=nrowgrids,
ncolgrids=ncolgrids,
unitarea=unitarea,
initlambda=initlambda,
initD=initD,
shrinkage=shrinkage,
currentZoI=currentZoI,
radiusOfInfluence=radiusOfInfluence,
Trap=Trap,
ntraps=ntraps,
saturationThreshold=saturationThreshold,
howClose=howClose,
dStep=dStep,
lengthBased=lengthBased,
lobsterSizeFile=lobsterSizeFile,
lobLengthThreshold=lobLengthThreshold,
trapSaturation=trapSaturation,
q0=q0,
qmin=qmin,
realizations=realizations,
tSteps=tSteps,
sexBased=sexBased,
lobsterSexDist=lobsterSexDist)
# Loop over list, initialize a parameter list and execute the simulations
Simrun  <- list()
Results <- list()
resultdfcomplete <- list()
for(i in 1:nsettings){
p <- list()
p$nrowgrids            <- param$nrowgrids[i]
p$ncolgrids            <- param$ncolgrids[i]
p$ngrids               <- param$nrowgrids[i] * param$ncolgrids[i]
p$unitarea             <- param$unitarea[i]
p$initlambda           <- param$initlambda[i]
p$initD                <- param$initD[i]
p$shrinkage            <- param$shrinkage[i]
p$currentZoI           <- param$currentZoI[i]
p$radiusOfInfluence    <- param$radiusOfInfluence[i]
p$Trap                 <- as.data.frame(param$Trap[i])
p$ntraps               <- param$ntraps[i]
p$saturationThreshold  <- param$saturationThreshold[i]
p$howClose             <- param$howClose[i]
p$dStep                <- param$dStep[i]
p$lengthBased          <- param$lengthBased[i]
p$lobsterSizeFile      <- param$lobsterSizeFile
p$lobLengthThreshold   <- param$lobLengthThreshold[i]
p$trapSaturation       <- param$trapSaturation[i]
p$q0                   <- param$q0[i]
p$qmin                 <- param$qmin[i]
p$realizations         <- param$realizations[i]
p$tSteps               <- param$tSteps[i]
p$sexBased             <- param$sexBased[i]
p$lobsterSexDist       <- param$lobsterSexDist
print( paste0('Run the simulation for parameter setting = ', i) )
Simrun[[i]]            <- SimulateLobsterMovement(p)
Results[[i]]           <- GetSimOutput(Simrun[[i]])
resultdfcomplete[[i]]  <- GetdfComplete(x = Results[[i]], extp = p)
saveRDS(object = resultdfcomplete[[i]], file = paste0('Set', i, '_varyingShrinkage', '.rds'))
}
Set1_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/shrinkageImpact/Set1_varyingShrinkage.rds")
Set7_varyingShrinkage <- readRDS("C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/shrinkageImpact/Set7_varyingShrinkage.rds")
View(Set7_varyingShrinkage)
variedsat <- list.files( path ='C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/shrinkageImpact/', pattern = "*.rds", full.names = TRUE ) %>%
map_dfr(readRDS)
variedsat$saturationThreshold <- factor(variedsat$saturationThreshold)
ggplot(variedsat, aes(x=densitylambda, y=maxcatchno)) +
stat_summary(fun.y=mean,  geom="line", aes(group = saturationThreshold, color=saturationThreshold, linetype=saturationThreshold)) +
stat_summary(fun.y=mean,  geom="point", aes(group = saturationThreshold, color=saturationThreshold)) +
xlab("Lobster density") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 7 of Addison & Bell paper replicated")
ggplot(variedsat, aes(x=densitylambda, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group = saturationThreshold, color=saturationThreshold, linetype=saturationThreshold)) +
stat_summary(fun.y=mean,  geom="point", aes(group = saturationThreshold, color=saturationThreshold)) +
xlab("Lobster density") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 7 of Addison & Bell paper replicated")
# fig 9
variedShrinkage <- list.files( path ='C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/', pattern = "*.rds", full.names = TRUE ) %>%
map_dfr(readRDS)
View(variedShrinkage)
variedShrinkage$baitShrinkage <- factor(variedShrinkage$baitShrinkage)
ggplot(variedShrinkage, aes(x=densitylambda, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
variedShrinkage$baitShrinkage
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
variedShrinkage$baitShrinkage
# fig 9
variedShrinkage <- list.files( path ='C:/Users/pourfarajv/Desktop/Kumu_R_Visulization/AgentbasedModeling/lobsterCatchV2023/resultsVP/NewResults/shrinkageImpact/', pattern = "*.rds", full.names = TRUE ) %>%
map_dfr(readRDS)
variedShrinkage$baitShrinkage <- factor(variedShrinkage$baitShrinkage)
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line")) +
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line") +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line") +
stat_summary(fun.y=mean,  geom="point", aes(group = baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group = baitShrinkage)) +
stat_summary(fun.y=mean,  geom="point") +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_line( color="grey") +
stat_summary(fun.y=mean,  geom="point") +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_line() +
stat_summary(fun.y=mean,  geom="point") +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_line() +
geom_point() +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1),group=baitShrinkage) +
geom_line() +
geom_point() +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1),group=baitShrinkage) +
geom_line() +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1,group=baitShrinkage)) +
geom_line() +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_line(aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_line(aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9 of Addison & Bell paper")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line") +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5, dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5, dstep=5")
# to get summary stats
summarydf<- variedShrinkage %>%
group_by( baitShrinkage) %>%
summarise(mean = mean(maxcatchno))
# to get summary stats
summarydf<- variedShrinkage %>%
group_by( baitShrinkage) %>%
summarise(mean = mean(MaxCatch_Trap1))
summarydf
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
geom_point() + geom_line()+
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5, dstep=5")
View(variedShrinkage)
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point() + geom_line()+
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5, dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point() + geom_line()+
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5, dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point()
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point(position = jitter) + geom_line()+
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point(position = "jitter") + geom_line()+
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point(position = "jitter") +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point() +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
range(variedShrinkage$MaxCatch_Trap1)
View(variedShrinkage)
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point(position = mean(MaxCatch_Trap1)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
geom_point(x=aes(mean(MaxCatch_Trap1))) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y="mean", geom="line", aes(group=factor(grouping)))+
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y="mean", geom="line", aes(group=factor(baitShrinkage)))+
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(fun.y="mean", geom="point", aes(group=factor(baitShrinkage)))+
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, shape = 17, size = 3, col = "red") +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line",  fun = mean, col = "blue")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, shape = 17, size = 3, col = "red") +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line", col = "blue")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, shape = 17, size = 2) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line", col = "blue")
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, size = 2) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line", col = "blue")
?stat_summary
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="line", aes(group=baitShrinkage)) +
#stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, size = 2) +
stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line", group=1)
ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line", aes(group=1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
#stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "point", fun = mean, size = 2) +
# stat_summary(aes(baitShrinkage, MaxCatch_Trap1), geom = "line", group=1)
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
fig9<- ggplot(variedShrinkage, aes(x=baitShrinkage, y=MaxCatch_Trap1, group=baitShrinkage)) +
stat_summary(fun.y=mean,  geom="line", aes(group=1)) +
stat_summary(fun.y=mean,  geom="point", aes(group=baitShrinkage)) +
xlab("Bait shrinkage factor") +
theme(panel.border = element_blank()) +
scale_y_continuous(name = "Mean cath (no lobster per trap)")  +
ggtitle("Fig 9; density=0.5 dstep=5")
ggsave(filename = "fig9.png", plot = fig9, width = 12, height = 10, dpi = 300, units = "cm")
